"""
This file is used to determine what model should be used for inference.
Early stopping is a form of regularization used to avoid overfitting.

Ideally this would be integrated into the training loop itself. However,
having already trained models I needed a way to select which model to use afterwards.
Either way, this achieves the same effect.
"""

patch_7c = [15.07676888, 7.14147806, 8.12860584, 6.03093672, 6.65428829, 6.26486111, 4.89569569, 3.74221492, 4.24098587, 4.47238445, 4.28701687, 4.14174414, 5.33335638, 4.43928814, 3.65916204, 4.13962841, 4.74225521, 3.60446215, 5.66396093, 5.21688175, 3.53813434, 5.2081461, 4.00005245, 5.116189, 4.05465889, 4.61948538, 3.33198428, 3.10306501, 3.56895781, 4.14136934, 3.3546834, 4.05378103, 4.04373026, 3.88673401, 3.42973781, 3.5652535, 3.99743843, 3.6999557, 4.36909103, 3.72004843, 3.85089564, 3.84897494, 3.55333471, 3.62489367, 3.57025719, 3.50854254, 3.6488235, 3.638237, 3.40710831, 3.35936213, 3.24712229, 3.14984465, 3.33240056, 3.73977041, 3.19849443, 3.59809875, 3.08032894, 3.26908541, 3.40250707, 3.47893214, 3.40702963, 4.09178638, 3.27904272, 3.76648712, 3.76158977, 3.64738846, 3.39888692, 3.79847956, 3.21028137, 3.79010534, 3.15402675, 3.2176919, 3.22948337, 3.64154291, 3.42094111, 3.28860426, 3.30246854, 3.21497583, 3.20194769, 3.6241889, 3.26649475, 3.56988096, 3.0587275, 3.41402006, 3.42100024, 3.06916904, 4.09404659, 3.4853816, 3.0883193, 3.19640493, 3.79550242, 3.11954236, 3.09675884, 3.23691821, 3.23369479, 3.28774142, 3.19222784, 3.14159393, 3.48503423, 2.99682879, 3.82516217, 3.28336668, 3.36317635, 3.17420101, 3.13791895, 3.04517484, 3.25491977, 3.32685733, 3.27291346, 3.26348686, 3.44652748, 3.55581999, 2.98105502, 3.10857344, 3.35151148, 3.13867784, 3.11188936, 3.02548075, 3.38346982, 3.08938551, 3.47847676, 3.05822158, 3.04696727, 3.1845746, 3.08257651, 3.3319695]
patch_5c = [13.9262104, 10.67207623, 5.83664942, 9.59089184, 3.76527405, 5.56882906, 3.96271372, 8.67961979, 5.25253963, 5.06001043, 5.18571997, 4.22895098, 4.93679571, 3.98937035, 5.19859314, 3.96118617, 3.54038763, 5.41351986, 5.24701405, 5.49543667, 4.26142502, 4.08948708, 4.63077211, 3.87147403, 3.94067001, 4.07772207, 3.92586637, 4.08522177, 3.30853844, 3.61829805, 3.7432282, 4.01266813, 4.69895411, 3.87269831, 4.28898907, 4.22624111, 3.32090139, 4.35394907, 3.9292655, 4.49979591, 3.46028185, 3.34274817, 3.65736628, 3.98849535, 3.56773329, 3.72102666, 3.96823812, 3.70147252, 3.35786319, 3.11710215, 4.12349987, 3.44485784, 3.46436262, 3.92651296, 3.95226932, 3.29852152, 3.67052078, 3.28835487, 3.43962932, 3.56970334, 3.56558371, 3.33553839, 3.8460393, 3.20287657, 3.24445295, 3.51491094, 3.1539073, 3.45946574, 3.27563238, 3.24114919, 3.55117273, 3.59264994, 3.10296822, 3.35982275, 3.43497539, 3.31336713, 3.4321816, 3.05763912, 4.11062145, 3.74305773, 3.53349614, 3.20935321, 3.49794126, 3.94020963, 3.30340505, 3.07616091, 3.54284811, 3.15965581, 3.20083356, 3.04315138, 3.24469709, 3.45358896, 3.26487231, 3.09834433, 3.70214319, 3.64543915, 3.16365409, 3.35431671, 3.29424906, 3.43659139, 3.14266443, 3.98939967, 3.45699263, 3.1579864, 3.21501207, 3.20205116, 3.52541614, 3.43071365, 3.45859289, 3.40004301, 3.57617569, 3.42912483, 3.33778572, 3.3046093, 3.17044139, 3.4165206, 3.21712685, 3.46911573, 3.87142229, 3.13837814, 3.35654593, 3.1668973, 3.3797183, 3.2033627, 3.99370837, 3.08212519, 3.56838274, 3.49401617, 3.55878401, 3.5540421, 3.455199, 3.0671401, 3.29419017, 3.23611975, 3.08107328, 3.14654613, 3.31418228, 4.00592852, 3.14651895, 3.13021541, 3.16619492, 3.23518562, 3.12744188, 3.53402448, 3.53708005, 3.30839467, 3.28627777, 3.41007543, 3.33130884, 3.25765657, 3.23594856, 3.34298015, 3.1003356, 3.11151195, 3.57025194, 3.51346064, 3.17783618, 3.00914001, 3.38840246, 3.28476024, 3.25792432, 3.31144667, 3.36555099, 3.20094347, 3.04267788, 3.15228891, 3.23280191, 3.16508889, 3.36322975, 3.17015982, 3.38842893, 3.2413373, 3.20192456, 3.160707, 3.23370862, 3.22860575, 3.4750104, 3.14285827, 3.25596571, 3.48405838, 3.18517303, 3.25276613, 3.0487957, 3.19686127, 3.18815422, 3.1480267]
patch_3c = [11.87641239, 6.11640072, 5.53506756, 5.00430727, 5.32840872, 3.72314715, 7.189363, 4.05625916, 4.53048992, 4.55481195, 5.09064198, 3.88193583, 3.56155896, 3.64938021, 3.71115041, 4.70603323, 4.36217117, 5.45770407, 3.17679596, 4.15937281, 3.58125162, 3.38703537, 4.24503469, 3.83481717, 4.43806744, 3.24099803, 4.13466263, 4.42204714, 3.07100463, 3.53968167, 3.84183121, 3.53494406, 3.22095609, 3.25910878, 2.99100757, 3.16947317, 3.52963305, 3.19347262, 3.66087604, 3.27139974, 3.21546888, 3.15232801, 3.53238225, 3.48311496, 3.37058973, 3.24771428, 3.1089561, 3.24289441, 3.00064421, 3.35416651, 3.99157214, 3.25538373, 3.04753351, 2.97890067, 3.49435759, 2.95312619, 2.92410016, 3.06739163, 3.04927039, 3.12122178, 2.99550104, 3.11563587, 3.24607205, 3.00946569, 3.13248396, 3.39727092, 3.23720789, 2.95614052, 2.78155756, 2.88429189, 3.0804677, 3.43946075, 3.1488471, 3.38364649, 3.10030317, 2.85647964, 2.98681378, 2.93654108, 2.90486026, 2.98070621, 2.99997377, 2.91853666, 3.28471684, 3.14795923, 3.5804317, 2.96690655, 3.01826334, 3.3912003, 3.05202842, 3.22127295, 3.01046777, 2.97845936, 2.8765099, 3.17364383, 3.04679608, 3.04562807, 2.88715506, 3.02575064, 2.90333056, 3.26815844, 3.12113619, 2.97813034, 2.94015646, 3.0285635, 3.19239283, 2.85092688, 3.24364853, 2.91335154, 3.10506654, 2.93176484, 3.03284121, 2.93349791, 2.98167825, 2.97369051, 2.89075351, 2.89438128, 3.16661072, 2.89658785, 2.97094464, 3.40795255, 2.86116862, 3.0571568, 3.01523471, 2.95824313, 2.89505816, 2.90740061, 3.24870372, 2.93613768, 3.43720961, 2.83435607, 2.80467772, 2.85537386, 2.90396953, 2.84565759, 3.13922071, 2.88914227, 2.90037179, 2.85418415, 2.84087563, 3.251297, 2.96338296, 2.90452433, 3.31935763, 2.79737425, 2.80758619, 2.8673315, 2.85970354, 2.82640886, 2.97712517, 2.84629965, 3.28042364, 2.92315483, 2.92180037, 2.94120193, 2.82334852, 3.0238986, 3.29716992, 2.86802268, 2.97957563, 2.93199611, 2.90160441, 3.14138198, 2.89936996, 3.45196652, 2.8512578, 3.05122423, 3.13184309, 2.76024175, 3.07825232, 2.87015533, 2.86104321, 2.8266902, 2.87487078, 2.99857664, 2.81856489, 2.80716181, 2.77482271, 2.90727615, 2.95981264, 2.90060687, 3.15084553, 2.92018747, 2.85076547, 2.93244672, 2.88278699, 3.17873144, 2.87173986, 2.82420683, 2.84403968, 2.84261799, 2.81306696, 2.97473216, 2.78651118, 2.85475993, 2.83588314, 2.92056155, 2.82104039, 2.87309813, 2.87371969, 2.88709259, 2.83279848, 2.91635084, 2.75980687, 2.8135457, 2.97374654, 2.97634888, 2.92060018]
rcaunetc = [8676.288263, 6641.241973, 4680.413811, 3518.245105, 2237.18601, 1414.641832, 880.9317701, 160.2835336, 86.11831355, 63.62168642, 66.18724562, 52.88078509, 71.2763538, 51.58294896, 69.98931954, 70.10709214, 88.60738433, 76.53005865, 50.77673576, 57.69384155, 60.39537038, 55.54759209, 66.42241768, 59.34709746, 56.58018406, 65.21023176, 58.15963505, 58.02108804, 56.46812816, 70.7867537, 58.70439483, 65.76588827, 67.83207986, 66.99558047, 63.95979469, 52.39192823, 66.73218566, 61.60578912, 58.6392424, 73.41407615, 63.99109294, 55.24556798, 58.2253272, 60.79211669, 66.411759, 56.38648276, 69.61868901, 62.44866636, 70.45659345, 73.6932974, 73.70337281, 70.28703969, 67.0179663, 61.42120186, 66.83404569, 72.17482759, 61.08590923, 63.68658121, 58.63896539, 58.07971882, 60.13377342, 62.24088943, 63.16650364, 64.61220116, 61.85932036, 64.79663857, 76.564355, 64.53774092, 77.00327239, 73.30788521, 66.04419895, 65.62402576, 61.12938581, 62.97449675, 66.18833158, 64.23368133, 65.71213373, 70.10182688, 73.61681342, 77.97028833, 63.76128427, 67.97700436, 66.97918711, 65.9183488, 68.47043566, 74.41671354, 68.76754415, 69.48429521, 68.48269064, 72.17058973, ]

r2_spatiotemporal_non_local_patch7c = [13.04343891, 9.40885353, 9.40866566, 7.55513668, 9.10220909, 10.3401947, 6.14245129, 7.55504894, 7.67856598, 6.0458951, 6.92469931, 5.4341712, 7.03937244, 6.22826385, 6.33642387, 6.21039295, 5.45236444, 5.63323116, 5.36432552, 5.66995335, 6.03277969, 5.28289032, 5.42223597, 5.11519527, 5.3006568, 5.19889545, 5.99895239, 5.19372082, 4.88108826, 4.99466085, 5.2905097, 5.68158484, 5.77085352, 5.44954777, 4.80539751, 5.70629644, 4.98905802, 5.6551733, 4.99060917, 4.79177713, 4.75530863, 4.58743572, 5.13088751, 4.96179104, 5.02085114, 5.46617794, 4.78595543, 4.65354729, 4.65843678, 4.41089678, 4.82907391, 4.72789192, 4.65708447, 4.94407177, 4.52999878, 4.45655298, 4.63006639, 4.46361303, 4.81795645, 4.96229506, 4.34279919, 4.2636714, 4.73684502, 4.56131792, 4.57169628, 4.52065182, 4.88579512, 4.51066208, 4.59607267, 4.63534403, 4.55602694, 4.56355762, 4.40625286, 4.42788315, 4.55356073, 4.66247654, 4.76637936, 4.50681353, 4.69086313, 4.3144598, 4.41010952, 4.38990498, 4.25010395, 4.43097162, 4.66179562, 4.74346733, 4.69956589, 4.37960911, 4.43759871, 4.24985313, 4.13600063, 4.41207457, 4.18211365, 4.48667288, 4.46711445, 4.8244381, 4.3547945, 4.36508083, 4.57458973, 4.36238194, 4.77519131, 4.35068607, 4.42667675, 4.33393955, 4.810853, 4.33871746, 4.36200809, 4.22497702, 4.2844696, 4.26111794, 4.39823437, 4.26993275, 4.17793131, 4.21482897, 4.27735567, 4.26779556, 4.28725195, 4.25175667, 4.20641327, 4.33720016, 4.29047871, 4.29630375, 4.28599596, 4.38550282, 4.23809099, 4.22943258, 4.2938242, 4.18076229, 4.35376072, 4.18355083, 4.2624197, 4.33558989, 4.1702795, 4.20326424, 4.21294737, 4.1729722, 4.10695934, 4.25260735, 4.22634125, 4.24640751, 4.29612255, 4.39848089, 4.75549889, 4.32668877, 4.08804893, 4.21757793, 4.23805237, 4.22391605, 4.14529276, 4.1521616, 4.21032667, 4.1724968, 4.23105097, 4.25700903, 4.21428728, 4.17547703, 4.16375589, 4.18548584, 4.28708029, 4.23040009, 4.12399387, 4.19261408, 4.11018133, 4.08690882, 4.26264095, 4.05456781, 4.11319065, 4.1800952, 4.10808325, 4.12412548, 4.46198654, 4.11875105, 4.10951757, 4.1555295, 4.1917119, 4.18154812, 4.29234362, 4.22449255, 4.16879034, 4.1315465, 4.17870998, 4.23286629, 4.25587749, 4.28288555, 4.11759329, 4.23743534, 4.12601566, 4.14992619, 4.24614048, 4.15910387, 4.12670994, 4.24968481, 4.16504765, 4.08498049, 4.1473155, 4.16984272, 4.13242388, 4.15837097, 4.12827253, 4.18770123, 4.07724762, 4.09600735, 4.10857487]
r2_temporal_non_local_patch7 = [8.1405077, 11.3214922, 5.73071527, 6.50741339, 7.86607742, 7.21777821, 5.96040726, 5.74334669, 5.44483566, 5.07830811, 5.06622744, 5.80893087, 4.85242844, 5.10035086, 5.17405224, 7.86214304, 5.67284489, 4.17338848, 5.70334864, 4.51280928, 4.52876759, 4.69755745, 4.72559214, 4.97291231, 4.29271269, 4.26297569, 4.54167271, 4.23775768, 3.9884994, 4.81511593, 5.12022066, 4.56394768, 4.0877924, 4.66841269, 4.60406923, 3.91459799, 3.74024963, 3.93812871, 4.329175, 4.89497185, 4.11111307, 4.68842554, 4.16169262, 5.85053587, 3.91467714, 3.77678728, 4.20616007, 4.28979778, 4.10604763, 3.95496225, 3.90691829, 4.1728735, 4.53711033, 4.13448095, 3.85454798, 3.68391919, 3.69969296, 3.87423968, 4.37592936, 4.59744835, 3.71127367, 3.74719167, 3.7596302, 3.82008672, 3.86855507, 3.74428415, 3.75656581, 3.753299, 3.92097402, 3.6419239, 3.90358806, 4.19512129, 3.83832097, 3.89585185, 3.78773999, 3.81505013, 3.63462114, 3.90715289, 4.03879929, 4.121768, 4.07810211, 4.12334061, 3.90179396, 3.71766782, 3.74953461, 3.67888498, 3.79345322, 3.64870715, 3.79931521, 3.79225111, 3.66253734, 3.8222301, 3.79314423, 3.73071337, 3.60048366, 3.70575905, 3.81182599, 3.63074446, 3.7337203, 3.80960846, 3.69703865, 3.94738817, 3.63827181, 3.71371222, 3.77711987, 3.64590383, 3.75550771, 3.64886093, 3.64718699, 3.7566402, 3.5647819, 3.83519697, 3.66555285, 3.61402822, 3.72047114, 3.74744749, 3.59096146, 3.82572746, 3.62498355, 3.66987157, 3.55864334, 3.78972387, 3.77412224, 3.53007841, 3.65478897, 3.7261188]
r2_noattention_patch7 = [13.49791241, 12.70451927, 9.70730877, 7.82528448, 7.21984768, 6.68675756, 7.58714771, 6.42951727, 6.23313665, 7.13084316, 6.83296824, 7.7961998, 5.7708087, 5.73978806, 5.3294239, 6.69772053, 5.76981449, 6.02048111, 5.16659451, 5.58581734, 5.62757206, 5.50103807, 4.96205807, 4.99210596, 5.18364239, 4.97561789, 5.00708103, 5.25183964, 4.68185139, 4.94998646, 4.93635559, 5.01198673, 4.69010258, 4.79919529, 4.63270235, 4.75362015, 4.65334034, 4.95782375, 4.72297955, 4.48593616, 4.63086796, 4.58643579, 4.76058531, 4.60705805, 4.76782131, 4.42510223, 4.53249168, 4.5884304, 4.30249882, 4.43803883, 4.49883366, 4.56711864, 4.33348179, 4.50853109, 4.50866175, 4.40367794, 4.3773551, 4.39002132, 4.28950119, 4.40319633, 4.24112749, 4.24555731, 4.28629684, 4.2137022, 4.42148733, 4.12755203, 4.23936939, 4.16309547, 4.37089348, 4.23714113, 4.09699249, 4.26964378, 4.1888442, 4.33776951, 4.17818022, 4.26609612, 4.23522282, 4.11179781, 4.40053558, 4.19494677, 4.1596961, 4.05855989, 4.08714199, 4.06554556, 4.22806454, 4.2614603, 4.12848663, 4.37995625, 4.04625607, 4.1074338, 4.25394201, 4.14616871, 3.98404503, 4.07521057, 4.0010891, 4.06563091, 4.16287231, 3.97669983, 4.10049343, 4.00227833, 4.03509092, 3.9985013, 4.0308919, 4.09587097, 3.99562526, 3.99566031, 3.9839561, 3.97775507, 4.02482319, 4.01066208, 4.053123, 4.05223179, 4.06060314, 4.08824015, 4.19079542, 3.98091936, 3.98888016, 4.05777121, 3.96476221, 3.98117018, 3.99522352, 3.97311211, 3.95975494, 4.07594252, 3.9875946, 3.97461748, 4.02994823, 4.07291698, 3.93603134, 3.98656702, 3.96312261, 3.94588327]

patch3_spatiotemporal_r2 = [14.03615093, 10.03844547, 15.12466431, 8.43647766, 11.82411575, 6.97490549, 5.59299755, 8.57108307, 7.74495554, 5.17020702, 6.67562389, 14.59071922, 5.24812841, 5.36636829, 6.22488165, 5.7031951, 5.97996759, 4.99882507, 4.39633465, 7.7282486, 4.90553856, 4.4317522, 4.66786098, 4.45795345, 5.46380186, 5.00873184, 4.71918344, 5.50227833, 4.64212418, 4.14770222, 4.11677837, 7.27416086, 7.13544226, 6.75380325, 7.05038595, 6.23163176, 4.99302959, 4.07174397, 4.25989103, 4.56787062, 4.2476263, 4.5545969, 4.04473019, 4.12111759, 4.11639404, 3.97566676, 4.17823553, 4.46931362, 3.9685986, 3.94309187, 3.75437689, 4.40232801, 5.04990864, 3.89817667, 3.86510229, 3.78303027, 4.44535494, 3.97105026, 3.90151858, 3.78562284, 4.00226974, 3.85841441, 4.12977457, 4.1147666, 4.10911608, 3.91346622, 3.88859558, 5.64904261, 3.95017743, 4.03280926, 3.81992865, 4.02904797, 4.87846136, 4.13096714, 3.78195643, 3.90314436, 4.78050709, 3.80465627, 3.64405441, 3.9523921, 3.71484995, 3.76116681, 3.78216314, 3.96192884, 3.78056765, 3.73137522, 3.58546448, 4.15474033, 4.27579451, 4.30337095, 3.67250299, 3.66760325, 3.77582884, 3.77258682, 3.81489372, 3.75232768, 3.67358255, 3.64989138, 3.63518906, 4.71576405, 3.82603574, 3.6916554, 3.76856089, 3.93543172, 3.68633389, 3.85599566, 3.8928113, 4.43093872, 3.66732931, 3.71540904, 3.62401438, 3.65877461, 3.92435718, 3.6677773, 3.8733623, 3.87035227, 4.07007074, 3.61535883, 3.60078955, 3.62700224, 3.58581495, 3.60157537, 3.55256152, 3.62242365, 3.65916014, 3.59459352, 3.62037206, 3.56477094, 3.62984514, 3.58487439, 3.66657901, 3.58117151, 3.55812716, 3.71360636, 3.5783577, 3.57163572, 3.62731791, 3.57255483, 3.71913481, 3.54798889, 3.62726355, 3.56700444, 3.57281494, 3.63121557, 3.58762121, 3.55521631, 3.59798884, 3.60372496, 3.58883524, 3.55152702, 3.56236696, 3.53455663, 3.76660109, 3.61854243, 3.56428337, 3.6431694]
patch3_noattention_r2 = [9.31862736, 19.96219254, 8.06696892, 7.577878, 6.39549828, 9.46797371, 5.17631197, 4.67718983, 5.00912762, 5.11744976, 5.15510464, 4.568923, 5.06060171, 6.2070961, 5.07579517, 4.50264978, 4.43581629, 4.93640804, 4.54438639, 4.68596506, 4.3196516, 4.79158735, 4.80787373, 4.3580904, 4.38422346, 6.28191662, 4.56697369, 4.49320412, 4.68483543, 4.48814726, 3.95718837, 5.37300587, 4.57683754, 4.33626652, 4.44816017, 4.627244, 3.76730657, 4.15082836, 3.90470457, 3.85272217, 4.06040859, 4.13954926, 3.84485316, 3.9706738, 4.37120056, 3.93051195, 4.16133118, 4.32962036, 4.05783081, 4.24687958, 3.71611595, 4.16553354, 3.80981207, 4.20323229, 4.00821304, 3.82934451, 4.53243208, 3.62699842, 3.8813076, 4.06898785, 3.83691931, 3.689363, 3.84828258, 3.70107651, 3.73254204, 3.69060588, 4.23543596, 3.64269495, 3.68258524, 4.20213938, 3.8077836, 3.64431, 3.6210084, 3.74621511, 3.68406987, 3.6155808, 3.81209683, 4.08155298, 3.63281679, 3.9105804, 3.63162994, 3.75531268, 3.59235311, 3.67019582, 3.71757436, 3.60108757, 3.65072107, 3.74760747, 3.71272898, 3.54353714, 3.58748746, 3.68178892, 3.62504506, 4.13483667, 4.36556196, 3.51357985, 3.63418889, 3.51008272, 3.67501402, 3.60201907, 3.70090103, 3.84853625, 3.55321765, 3.87709761, 3.57908893, 3.60753179, 3.89099503, 3.53144765, 3.55790663, 3.5172627, 3.52839398, 3.51752234, 3.55887914, 3.67687178, 3.49927092, 3.63943052, 3.61624956, 3.60755157, 3.5574379, 3.48953056, 3.5152564, 3.56951714, 3.48172712, 3.59425616, 3.72293472, 3.55379248, 3.60251164, 3.50222588, 3.68073535, 3.56994128, 3.51954913, 3.47990656, 3.46706533, 3.5632596, 3.67665172, 3.51050997, 3.47340703, 3.73106074, 3.4731853, 3.48942828, 3.56639814, 3.52844739, 3.47849417, 3.49051094, 3.64407277, 3.53479576, 3.53724718, 3.52056551, 3.46857214, 3.4877553, 3.46341372, 3.48923159, 3.50714731, 3.61507225, 3.49590111, 3.46160245, 3.4493413, 3.59203339, 3.43972826, 3.50046611, 3.44948149, 3.4686141, 3.44871259, 3.45781469, 3.513659, 3.49609184, 3.46263051, 3.46865702, 3.54055476, 3.66069794, 3.44921446, 3.46732855, 3.4871974, 3.46668744]

oksuz_lstm_noattention_unidirectional = [15.84261894, 14.51052666, 11.32674885, 96.70438385, 15.50070858, 12.3196249, 9.03625488, 8.95788956, 8.58657265, 6.59890318, 6.84757376, 6.69316483, 6.66316032, 9.04416561, 5.49746704, 5.90281868, 20.43404198, 10.46604538, 10.56042099, 13.68776798, 8.21768379, 7.52719879, 6.48276997, 6.26493883, 5.65801764, 6.62417746, 5.63287115, 5.60061407, 5.58190155, 5.48586893, 5.61719799, 5.19116783, 5.25850773, 4.98681545, 4.97378445, 5.64553642, 4.91110706, 4.90038204, 4.89864683, 4.93623352, 5.33862638, 5.62994814, 5.25107241, 4.69869566, 4.73722267, 4.62396049, 4.86146164, 4.84678411, 4.67307854, 5.13259315, 4.96844387, 4.58896208, 5.13517475, 5.5275588, 5.16218758, 5.02014399, 4.74125433, 5.17718315, 4.85734224, 5.0113678, 4.60879421, 4.99271917, 4.68189526, 4.58127928, 4.679636, 4.58083725, 4.57245159, 4.49006224, 4.81299686, 4.59769344, 4.645329, 4.59051704, 4.67774057, 4.51435423, 4.63617802, 4.49939966, 4.51009893, 4.51720619, 4.67509937, 4.62403297, 4.48823929, 4.5381918, 4.6141448, 4.95051336, 4.5239172, 4.44399548, 4.86538887, 4.65951443, 4.48348475, 4.56786919, 4.53652668, 4.54331541, 4.57793999, 4.44059849, 4.40151787, 4.60146809, 4.48282671, 4.56124592, 4.40613365, 4.61797762, 4.58366537, 4.43697357, 4.59345865, 4.4529438, 4.74510384, 4.44292307, 4.47055387, 4.5310235, 4.55682087, 4.49280071, 4.32910442, 4.46485472, 4.41507006, 4.46310806, 4.39007759, 4.368536, 4.44500303, 4.55902624, 4.50513744, 4.35214663, 4.43359375, 4.44164467, 4.50494194, 4.3325429, 4.67978239, 4.55140018, 4.51647902, 4.33430052, 4.42325068, 4.41127157, 4.4327116, 4.39925957, 4.44969034, 4.52833462, 4.36778307, 4.41755247, 4.35021782, 4.34379387, 4.37063646, 4.34173536, 4.36057615, 4.48806095, 4.34505606, 4.3631382, 4.36301184, 4.40574932, 4.39758348, 4.39974022, 4.35477638, 4.41018009, 4.35042, 4.35438681, 4.41587877, 4.32394171, 4.35884571, 4.35645485, 4.36717319, 4.34028769, 4.41031218, 4.39302588, 4.38247395, 4.31032133, 4.33656025, 4.34702873, 4.33456993, 4.33819151, 4.29592466, 4.4086895, 4.29304647, 4.31565189, 4.32979012, 4.29523182, 4.38527632, 4.27149487, 4.34420681, 4.3113451, 4.3350091, 4.31864595, 4.40825605, 4.31917572, 4.3582406, 4.35917234, 4.33998156, 4.3543663, 4.3233633, 4.3690877, 4.37879944, 4.33949232, 4.35165119, 4.3003602, 4.29417658]
oksuz_gru_noattention_unidirectional = [80.89421082, 10.96794891, 9.17604828, 8.18189049, 9.35280895, 6.27542973, 6.2636919, 6.49169016, 6.368083, 8.60260582, 6.58898926, 5.97437811, 5.89887905, 5.32316971, 5.40073681, 6.24511147, 6.3285985, 5.43246126, 5.24354553, 5.4635191, 5.34381628, 5.52153349, 5.29182673, 5.15558577, 5.10523558, 6.21205664, 5.42932415, 5.22068644, 5.36545181, 5.01892233, 5.85131502, 5.67404795, 5.079772, 4.97170353, 6.11616182, 5.29020214, 5.24883938, 4.98227549, 4.71004343, 5.33666277, 4.68776226, 5.92388058, 6.1680212, 6.42526531, 4.85028505, 4.73832893, 5.37129498, 4.8597703, 5.14348841, 5.05102587, 5.24475765, 4.71499252, 4.92878008, 4.66292048, 4.6590085, 4.81126404, 4.83431387, 4.84972095, 4.69782877, 4.86479998, 4.66240597, 5.35359097, 4.6818037, 4.85001421, 4.51053905, 5.0444293, 5.03975773, 4.79584885, 4.54137182, 4.44470215, 4.50842762, 5.00091457, 4.5941267, 4.58629751, 5.22725677, 4.66540194, 4.77802563, 4.40792561, 4.54282093, 4.64695787, 4.5502739, 4.98842096, 4.56690645, 4.77667713, 4.54590607, 4.54529858, 4.61974144, 4.65695953, 4.86295223, 4.48180199, 4.47882938, 4.48897886, 4.42857885, 4.53754282]
cohen_original = [16.39037895, 7.35101843, 7.04162216, 6.56072855, 5.95678425, 6.18181658, 6.15721035, 6.04281902, 5.96765947, 6.16126871, 6.25525761, 5.82472515, 5.73128271, 5.84604073, 6.09989834, 5.85665369, 6.24565077, 5.55579424, 5.74391031, 5.96066093, 5.74021149, 5.52812719, 6.05955553, 5.74053288, 5.63028669, 5.53620577, 5.51199961, 5.51909351, 5.61716413, 5.67545033, 5.49935913, 5.7854147, 5.81028175, 5.7727232, 5.55583286, 5.43659735, 5.46478748, 5.3741889, 5.38357544, 5.4266367, 5.31633234, 5.41808128, 5.45335674, 5.49412012, 5.38986778, 5.4587841, 5.41498566, 5.34052753, 5.12786579, 5.19962215, 5.35665941, 5.32972813, 5.33088684, 5.1886034, 5.20190334, 5.11201763, 5.16204214, 5.142241, 5.02094793, 5.09238005, 5.22905636, 5.0995636, 5.07195091, 5.18386841, 5.24464512, 5.22174931, 5.17808056, 5.02359486, 5.08224773, 4.97629166, 5.0095129, 5.06009007, 5.10271358, 4.9978056, 4.93620443, 4.929111, 4.978158, 5.06468821, 4.86823177, 4.87050772, 4.90862036, 4.91493559, 4.86465454, 4.97580051, 4.89586353, 4.91373205, 4.86777544, 4.85923004, 4.80727482, 4.82484722, 4.81721401, 4.85320377, 4.80729055, 4.97261953, 4.91971397, 4.73010302, 4.85797739, 4.83105183, 4.68877268, 4.79543447, 4.81494761, 4.80803585, 4.756145, 4.74935389, 4.72896099, 4.81357288, 4.74388266, 4.72892952, 4.72533894, 4.71005297, 4.82680082, 4.74470234, 4.74300289, 4.69457197, 4.68797398, 4.68199062, 4.64856672, 4.63527584, 4.66070557, 4.63378859, 4.64527464, 4.676476, 4.68142796, 4.66309834, 4.62711954, 4.69428587, 4.65003347, 4.65662098, 4.64318562, 4.64718771, 4.64278555, 4.65010405, 4.59534645, 4.6338172, 4.62690306, 4.58946466, 4.58664989, 4.6181035, 4.61901999, 4.57465553, 4.59979153, 4.60836124, 4.53668261, 4.56192493, 4.55325937, 4.57200289, 4.56740618, 4.57779789, 4.60222101, 4.54401875, 4.54745388, 4.57441616, 4.57536554, 4.51889277, 4.55770969, 4.56497097, 4.53002691, 4.5557375, 4.5140295, 4.53840446, 4.54808569, 4.55258846, 4.51603222, 4.5441308, 4.52197886, 4.51873302, 4.52767563, 4.5195756, 4.53153753, 4.51282597, 4.49181366, 4.51722193, 4.48516607, 4.50897789, 4.51669025, 4.52667427, 4.52835178, 4.49805355, 4.51089239, 4.4872632, 4.48468828, 4.50958204, 4.48099279, 4.46239567, 4.47351885, 4.48359442, 4.48050594, 4.49070454, 4.46296978, 4.46305323, 4.46781015, 4.47514629, 4.47968149, 4.50095844, 4.48232603, 4.48791218, 4.45491314, 4.47102213, 4.48101139, 4.44875669, 4.4616828, 4.45139265, 4.4349966, 4.4415822, 4.46158838, 4.47046757, 4.42571068, 4.4467063, 4.43584871, 4.4527483, 4.43834448, 4.47045612, 4.44700623, 4.4431777, 4.45164633, 4.44674063, 4.44936466, 4.45613527, 4.42092085, 4.43104696, 4.43144989, 4.43117428, 4.437356, 4.40393162, 4.41675472, 4.45811987, 4.42351961, 4.4100647, 4.43153524, 4.40223217, 4.41588306, 4.43177271, 4.41025686, 4.41476536, 4.40739679, 4.40161037, 4.41814137, 4.40711737, 4.42259502, 4.40437031, 4.38972998, 4.43863487, 4.39517784, 4.40941334, 4.42859793, 4.40311909, 4.40308666, 4.4265852, 4.40701962, 4.39035654, 4.41325474, 4.41417599, 4.41089439, 4.41612339, 4.4149909, 4.41949081, 4.41256905, 4.41593599, 4.41490459, 4.39672375, 4.40285587, 4.39778519, 4.3900876, 4.38853455, 4.39982414, 4.40024662, 4.40611982, 4.39471483, 4.4417429, 4.40164471, 4.40424585, 4.39268398, 4.38739395, 4.39651012, 4.40340614, 4.40189791, 4.38937855, 4.38706493, 4.37170172, 4.40939379, 4.39792728, 4.36367702, 4.40120745, 4.39101171, 4.40147448, 4.39580441, 4.39191008, 4.39375591, 4.39222145, 4.38909149, 4.39019012, 4.38748693, 4.37995434, 4.38104677, 4.3783679, 4.37956619, 4.38453674, 4.3890748, 4.36211824, 4.38055134, 4.37473202, 4.38490391, 4.38311863, 4.3747654, 4.38729477, 4.38563442, 4.37471867, 4.38499928, 4.37946606, 4.37498188, 4.39372253, 4.37458038, 4.35751867, 4.37974596, 4.38183212, 4.37801981, 4.38972187, 4.37497807, 4.3720293, 4.36195993, 4.37816095, 4.37315083, 4.37726068, 4.36136341, 4.38994646, 4.38266659, 4.37485552, 4.37897778, 4.36720181, 4.37212849, 4.37384558, 4.36919689, 4.37531471, 4.37428331, 4.37205029, 4.37054682, 4.37365055, 4.36211824, 4.37410593, 4.37299633, 4.37438726, 4.3667469, 4.37032413, 4.36968565, 4.35534334, 4.36720276, 4.36271, 4.37688541, 4.36354351, 4.37457609, 4.36608934, 4.36085939, 4.36050129, 4.36186075, 4.3846283, 4.36829281, 4.36878586, 4.36245108, 4.35769749, 4.37306166, 4.36831093, 4.36979389, 4.37910652, 4.35316372, 4.37473583, 4.36155796]
cohen_modern = [16.0410881, 7.83575439, 7.7559824, 6.49919605, 6.12085485, 6.06038094, 5.9564209, 5.90445471, 7.46224308, 6.52966022, 5.91560793, 6.06906605, 5.89153194, 5.87397337, 5.70035076, 5.61196327, 5.59405708, 5.9857049, 5.82198668, 5.72150278, 6.32667494, 5.75121593, 5.47450161, 5.77372646, 5.57982731, 5.60656071, 5.5514431, 5.57301188, 5.61326313, 5.63063431, 6.10610485, 5.53355169, 5.63214493, 5.58712578, 5.72838068, 5.57198429, 5.75809765, 5.49074793, 5.45206738, 5.37169743, 5.57722235, 5.53294945, 5.44173717, 5.30988979, 5.53416681, 5.40838194, 5.41680288, 5.74771214, 5.35144424, 5.69934464, 5.28484058, 5.31614971, 5.27379704, 5.30415344, 5.31111574, 5.28663492, 5.36956549, 5.25738668, 5.13577127, 5.29860258, 5.10627079, 5.16300583, 5.3293848, 5.20164204, 5.14864445, 5.20776081, 5.14989042, 5.21640682, 5.19686174, 4.98229456, 5.28028965, 5.20051098, 5.00847816, 5.08614969, 5.11769772, 5.20074606, 4.9498148, 5.15304804, 4.96190786, 5.01194239, 4.93918228, 4.95174694, 4.94700909, 5.03871202, 4.94933462, 4.93466806, 5.03393221, 5.02609348, 4.89994335, 5.14683151, 4.91156101, 5.12631559, 5.02107048, 4.8889966, 4.91026163, 4.90355968, 4.89805841, 4.8838315, 4.90153885, 4.94550657, 4.86637402, 4.84662151, 4.84912825, 4.84028578, 4.92900562, 4.88554859, 4.89688969, 4.80673409, 4.93197107, 4.86073732, 4.81887197, 4.78523588, 4.89697981, 4.87680864, 4.78161907, 4.82701063, 4.76984787, 4.84249306, 4.82009697, 4.7582798, 4.79076099, 4.79742289, 4.79131556, 4.76831913, 4.71933508, 4.73647118, 4.75496531, 4.75809336, 4.81255054, 4.79980183, 4.6990757, 4.70191431, 4.7243948, 4.77642155, 4.77771664, 4.70794201, 4.70306683, 4.67226505, 4.71707821, 4.70081091, 4.72280502, 4.72647285, 4.68905926, 4.74699402, 4.72424603, 4.69426155, 4.69922924, 4.69297934, 4.65826893, 4.6794343, 4.63634396, 4.67616177, 4.67336798, 4.66641855, 4.66983652, 4.64457226, 4.70259428, 4.62859392, 4.6716814, 4.65957117, 4.63915014, 4.65249872, 4.84469891, 4.6624279, 4.64196968, 4.64367199, 4.64285135, 4.7056284, 4.60964632, 4.64320374, 4.70100641, 4.6402421, 4.61870432, 4.66124678, 4.61881542, 4.63016462, 4.63566303, 4.60134172, 4.61042595, 4.62794018, 4.6292057, 4.66787052, 4.62224102, 4.64831352, 4.62144947, 4.65288448, 4.64389372, 4.62500191, 4.66459322, 4.60299015, 4.63087654, 4.60960627, 4.59477901, 4.57000208, 4.61096668, 4.63323164, 4.60263014, 4.60735321, 4.57665205, 4.58725452, 4.56843662, 4.58864641, 4.60754395, 4.59029484, 4.59174061, 4.56544209, 4.5648098, 4.57605839, 4.59972, 4.57417107, 4.5700407, 4.57771254, 4.59485531, 4.55511665, 4.59886885, 4.55580521, 4.58385372, 4.56777477, 4.57908201, 4.58817101, 4.55287695, 4.58195782, 4.557374, 4.53825092, 4.55180645, 4.5711956, 4.56607771, 4.5542326, 4.54976082, 4.58065557, 4.55565596, 4.57646418, 4.5407095, 4.54717255, 4.53121901, 4.55441856, 4.55321026, 4.54853821, 4.54466915, 4.53120518, 4.56746054, 4.53962374, 4.54643536, 4.52279615, 4.54714775, 4.54609776, 4.57283211, 4.54358816, 4.56387949, 4.53574562, 4.53799534, 4.53915596, 4.53610563, 4.5494318, 4.55130863, 4.54795027, 4.55968475, 4.53681993, 4.53813457, 4.53386402, 4.52257967, 4.52693462, 4.53765059, 4.52379274, 4.53806734, 4.5334239, 4.52928782, 4.53141212, 4.52400684, 4.51216555, 4.51300764, 4.52202082, 4.53593922, 4.51301098, 4.52677917, 4.52733946, 4.53729391, 4.53257751, 4.51810932, 4.5174551, 4.50592327, 4.51157761, 4.51821995, 4.52976227, 4.51914692, 4.52567196, 4.52025843, 4.54879761, 4.5083704, 4.52787733, 4.51827383, 4.52447939, 4.5100832, 4.51141882, 4.51103687, 4.50805998, 4.52362728, 4.51980257, 4.51977682, 4.50836897, 4.51992321, 4.50695515, 4.50889587, 4.50711584, 4.51358271, 4.50012302, 4.50969076, 4.51769352, 4.51061726, 4.50674391, 4.51142406, 4.51934147, 4.5153265, 4.52786541, 4.5133276, 4.50845575, 4.51735687, 4.51018953, 4.51763201, 4.51071024, 4.52544022, 4.51421309, 4.49810362, 4.50985861, 4.51883173, 4.50953817, 4.51282644, 4.5087142, 4.49924374, 4.50399208, 4.51603794, 4.51480961, 4.50367689, 4.50067234, 4.50144863, 4.49986219, 4.50896835, 4.51270771, 4.51347589, 4.5036664, 4.5053339, 4.51014614, 4.50837183, 4.51271486, 4.49699831, 4.50320005, 4.50643349, 4.49320698, 4.50052071, 4.49738216, 4.51680088, 4.50050259, 4.50273132, 4.50838614, 4.50311804, 4.50682116, 4.50806189, 4.49478436, 4.50359297, 4.50068474, 4.5131402, 4.5035181, 4.49970341, 4.49821186, 4.5074358, 4.50469637]

hoppe_medium = [13.12813091, 15.89436913, 12.50814724, 10.45149803, 10.40056038, 15.85271168, 10.80560207, 10.74531746, 9.77660084, 9.31302357, 9.60096169, 9.14252663, 9.16781998, 9.84544373, 8.96056938, 9.35314369, 9.6389637, 9.3883543, 9.87074947, 9.32768059, 8.96360302, 8.8990736, 9.33101082, 10.65231037, 9.19638348, 9.12476158, 8.8007021, 10.76996231, 8.708004, 8.70213795, 8.7347374, 8.97714138, 9.18447685, 9.51900673, 9.03903008, 9.04238415, 8.67562389, 8.88633919, 8.56512547, 8.5729332, 9.88713264, 8.61549568, 9.08904076, 8.80345058, 8.97263813, 9.13150597, 8.56087971, 8.52454185, 8.57231617, 8.92399788, 8.47490311, 8.52766991, 9.02937222, 8.48007774, 8.509408, 8.71557808, 8.61287594, 8.53729439, 8.42646313, 8.6548748, 8.80703068, 8.45971489, 8.48657799, 8.51486683, 8.3930254, 8.72338676, 8.75769615, 8.74448776, 8.39399242, 8.76686287, 8.72194099, 8.45115185, 8.43047428, 8.87791443, 8.53576374, 8.6260252, 8.50398731, 8.42313576, 8.44350147, 8.37645721, 8.36456108, 8.42327499, 8.38730526, 8.48697186, 8.50098991, 8.35193348, 8.56571388, 8.41974926, 8.48911095, 8.403368, 8.37071991, 8.40380001, 8.42886829, 8.33672333, 8.371912, 8.40490246, 8.40605354, 8.38005066, 8.42890644, 8.37342072, 8.48388004, 8.413517, 8.35340309, 8.34821224, 8.47661781, 8.33104992, 8.27156067, 8.35743427, 8.4116993, 8.38386726, 8.35985756, 8.42364788, 8.29283237, 8.39166069, 8.33502102, 8.36047077, 8.3514595, 8.39046478, 8.32781792, 8.37428284, 8.34198952, 8.36106491, 8.31543827, 8.37037277]
hoppe_mean = [23.91623306, 19.31636429, 14.031744, 14.77974224, 12.51640987, 11.6506815, 13.57774639, 16.30880547, 9.83874416, 9.93584347, 11.21496773, 10.42737865, 10.63521671, 9.38832951, 9.6842289, 24.02497292, 9.45464516, 11.57398701, 12.36637402, 10.55758953, 10.33236027, 11.52366829, 10.2954731, 9.11561775, 8.95246887, 9.46973801, 9.31537533, 10.07198334, 10.37802315, 11.69985485, 9.90744686, 9.18056583, 18.30251694, 13.92833233, 8.96093464, 12.45965862, 10.23125458, 9.59074593, 11.47272396, 9.83172417, 9.30900288, 8.99678993, 9.64813042, 8.94229317, 11.29495811, 9.32326698, 10.83531189, 8.91209888, 9.57792664, 10.0865078, 9.73970318, 9.80653667, 8.81438446, 9.92141533, 9.10731983, 9.65714264, 9.39805508, 11.39919567, 9.4590044, 9.01540184, 8.90200901, 8.8017025, 8.68229389, 8.61919594, 10.12820625, 8.83097458, 10.97059059, 8.66774559, 8.8528347, 11.85634613, 9.91665745, 8.74070263, 9.03953362, 9.11838436, 8.72191811, 8.7745924, 8.99606323, 8.85336113, 8.7066288, 8.67827797, 9.64838028, 9.11206913, 8.90726566, 9.14640141, 8.84555626, 8.7145834, 8.73926258, 8.66909409, 8.68008232, 8.7118988, 8.74825382, 8.55081272, 9.22681618, 8.6720705, 8.63332176, 8.58662224, 8.75424099, 8.64256859, 9.18832588, 8.63718987, 10.25032043, 9.16303825, 8.63834953, 8.55835438, 8.6193285, 8.78650475, 8.62671471, 8.82594013, 8.56443405, 8.5082531, 8.53977394, 8.76499939, 8.55709553, 8.53278637, 8.64374065, 8.7457962, 8.53273487, 8.51668549, 8.86895084, 8.55309296, 8.59066963, 8.53572273, 8.49701786, 8.58020878, 8.42117596, 8.55295563, 8.5877285, 9.29641056, 8.5122242, 8.4479084]

r2_unfactorised_patch3 = [9.5234623, 7.34345484, 9.21866894, 6.86687469, 7.41255426, 5.1324892, 5.55124187, 5.77933168, 4.63813305, 5.71895885, 4.77360964, 5.18478918, 4.64546013, 5.07888842, 5.43072557, 4.86178875, 4.66684389, 4.80578518, 5.00008488, 4.43108273, 4.768888, 4.75982761, 4.48096561, 5.00746298, 4.59511471, 4.51330853, 4.3451395, 4.83051205, 4.33717012, 4.15649414, 4.37846088, 4.1577282, 4.27083826, 4.19098425, 4.24366713, 4.6269083, 4.26488113, 4.44928503, 4.24529505, 4.27558184, 4.2631855, 4.02323866, 4.09444141, 4.14207315, 4.21999454, 4.25510883, 4.20928192, 4.25097132, 4.15540409, 4.31321955, 4.15263939, 4.03578901, 4.20470905, 3.94138861, 4.25654221, 4.02978134, 4.06770039, 3.95026445, 4.02167606, 4.02121592, 3.94943762, 3.95415568, 3.99403524, 3.94811773, 4.12141752, 3.95169687, 3.94209218, 3.86029935, 3.95774269, 3.94006777, 4.10302925, 3.95259905, 4.019207, 3.97265863, 3.93535376, 3.9310441, 3.90413213, 3.95277143, 3.99490047, 4.05985022, 3.97940898, 3.86078024, 3.91218495, 3.88763356]

# import numpy as np
# print(np.argmin(np.array(patch_7c[:100])) + 1)

experiment_name = r2_unfactorised_patch3
patience = 15

ignore_first_n_epochs = 50
experiment_name = experiment_name[ignore_first_n_epochs:]
def find_stop_epoch(experiment):
    lowest_error = experiment[0]
    lowest_epoch = 0
    no_imp = 0

    for epoch, metric in enumerate(experiment):
        if metric < lowest_error:
            lowest_error = metric
            lowest_epoch = epoch
            no_imp = 0

        if no_imp > patience:
            return lowest_epoch + 1, lowest_error

        no_imp += 1

    raise ValueError("No chance to stop")


e, i = find_stop_epoch(experiment_name)

print(f"Patience: {patience}, Epoch: {e + ignore_first_n_epochs}, Error: {i}")